{% extends "base.html" %}

{% block content %}
<h2>Editar Incidencia: {{ item.nombre }}</h2>
<form action="{{ url_for('update_correctivo', id=item.id) }}" method="POST" enctype="multipart/form-data" class="mt-4"><div class="row"><div class="col-md-6"><div class="mb-3"><label class="form-label">Nombre</label><input type="text" class="form-control" name="nombre" value="{{ item.nombre }}" required></div><div class="mb-3"><label class="form-label">Equipo</label><select class="form-select" name="equipo_id" required>{% for eq in equipos %}<option value="{{ eq.id }}" {{ 'selected' if eq.id == item.equipo_id }}>{{ eq.nombre }}</option>{% endfor %}</select></div><div class="mb-3"><label class="form-label">Comentario</label><textarea class="form-control" name="comentario" rows="3">{{ item.comentario }}</textarea></div><div class="mb-3"><label class="form-label">Solución</label><textarea class="form-control" name="solucion" rows="3">{{ item.solucion }}</textarea></div></div><div class="col-md-6"><div class="row"><div class="col-md-6 mb-3"><label class="form-label">Fecha Detectada</label><input type="date" class="form-control" name="fecha_detectada" value="{{ item.fecha_detectada }}" required></div><div class="col-md-6 mb-3"><label class="form-label">Fecha Resolución</label><input type="date" class="form-control" name="fecha_resolucion" value="{{ item.fecha_resolucion or '' }}"></div><div class="col-12 mb-3"><label class="form-label">Estado</label><select class="form-select" name="estado"><option value="Detectada" {{ 'selected' if item.estado == 'Detectada' }}>Detectada</option><option value="En curso" {{ 'selected' if item.estado == 'En curso' }}>En curso</option><option value="Resuelta" {{ 'selected' if item.estado == 'Resuelta' }}>Resuelta</option></select></div></div><div class="card mb-3"><div class="card-header d-flex justify-content-between align-items-center"><span>Imágenes ({{ imgs|length }}/5)</span><small class="text-muted">Selecciona para borrar</small></div><div class="card-body">{% if imgs %}<div class="list-group mb-2">{% for img in imgs %}<div class="list-group-item d-flex justify-content-between align-items-center p-1"><small class="text-truncate" style="max-width: 200px;">{{ img.name }}</small> <input class="form-check-input" type="checkbox" name="delete_images" value="{{ loop.index0 }}"></div>{% endfor %}</div>{% endif %}{% if imgs|length < 5 %}<input type="file" class="form-control form-control-sm" name="images" multiple accept="image/*">{% endif %}</div></div><div class="card"><div class="card-header d-flex justify-content-between align-items-center"><span>PDFs ({{ pdfs|length }}/5)</span><small class="text-muted">Selecciona para borrar</small></div><div class="card-body">{% if pdfs %}<div class="list-group mb-2">{% for pdf in pdfs %}<div class="list-group-item d-flex justify-content-between align-items-center p-1"><small class="text-truncate" style="max-width: 200px;">{{ pdf.name }}</small> <input class="form-check-input" type="checkbox" name="delete_pdfs" value="{{ loop.index0 }}"></div>{% endfor %}</div>{% endif %}{% if pdfs|length < 5 %}<input type="file" class="form-control form-control-sm" name="pdfs" multiple accept="application/pdf">{% endif %}</div></div></div></div><hr><div class="d-flex justify-content-end gap-2"><a href="{{ url_for('correctivos') }}" class="btn btn-secondary">Cancelar</a><button type="submit" class="btn btn-primary">Guardar Cambios</button></div></form>
{% endblock %}